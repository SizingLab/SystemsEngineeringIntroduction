

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2.2. Temperature Control Lab, step identification &#8212; Introduction to Mechatronics and System Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebook/06b_TD2_TCLab_IdentificationStep-Student';</script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.3. PID digital controller: Python implementation" href="07_TD_PID_ControlLoops-Student.html" />
    <link rel="prev" title="2.1. Temperature Control Lab, step identification (a)" href="06a_TD2_TCLab_Step-Student.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../about/homepage.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Mechatronics and System Engineering - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Mechatronics and System Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about/syllabus.html">Course Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Systems Engineering Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01a_CM1_Systems_SpaceSystems.html">Complex technological systems and space systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="01b_CM1_SystemEngineering.html">System engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_CM3_Introduction2MultiPhysicModeling.html">Introduction to multiphysics modeling of sizing scenarios</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_CM4_SoftwareDevelopment_TCLabIntroduction.html">Control software development</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Preparation of work sessions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tuto_00_SoftwareInstallation.html">Software Installation Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tuto_01_Python.html">Introduction to Python Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tuto_02_ArduinoTCLab.html">Introduction to Arduino Usage and Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermal control system of a cubesat</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="summaryPartA.html">1. Technical requirements definition</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="02_CM2_ThermalControlSystems.html">1.1. Thermal Control System</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_TD1_CubeSatThermalModeling_Student.html">1.2. Thermal Model for CubeSat</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="summaryPartB.html">2. Control software definition</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="06a_TD2_TCLab_Step-Student.html">2.1. Temperature Control Lab, step identification (a)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.2. Temperature Control Lab, step identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_TD_PID_ControlLoops-Student.html">2.3. PID digital controller: Python implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_TD_PIDArduinoImplementation.html">2.4. Digital controller: Arduino implementation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Attitude control system of a cubesat</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Bonus_01_SCAO.html">Attitude control system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bonus_02_Maquette.html">1U Cubesat model with a reaction wheel</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/SizingLab/SystemsEngineeringIntroduction/main?urlpath=lab/tree/notebook/06b_TD2_TCLab_IdentificationStep-Student.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/SizingLab/SystemsEngineeringIntroduction/blob/main/notebook/06b_TD2_TCLab_IdentificationStep-Student.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SizingLab/SystemsEngineeringIntroduction" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SizingLab/SystemsEngineeringIntroduction/edit/main/notebook/06b_TD2_TCLab_IdentificationStep-Student.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SizingLab/SystemsEngineeringIntroduction/issues/new?title=Issue%20on%20page%20%2Fnotebook/06b_TD2_TCLab_IdentificationStep-Student.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebook/06b_TD2_TCLab_IdentificationStep-Student.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Temperature Control Lab, step identification</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-step-change-data-to-a-first-order-model">2.2.1. Fitting the Step Change Data to a First Order Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nodal-thermal-model">2.2.2. Nodal thermal model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-model">2.2.3. Two State Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-first-order-to-second-order-thermal-model">2.2.3.1. From first order to second order thermal model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-second-order-model-by-least-squares">2.2.3.2. Fitting a Second Order Model by Least Squares</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction">2.2.4. Correction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">2.2.5. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="temperature-control-lab-step-identification">
<h1><span class="section-number">2.2. </span>Temperature Control Lab, step identification<a class="headerlink" href="#temperature-control-lab-step-identification" title="Permalink to this heading">#</a></h1>
<p>The <a class="reference external" href="https://apmonitor.com/pdc/index.php/Main/ArduinoTemperatureControl">temperature control lab</a> or TCLab is a laboratory device used for thermal projects. It can be used to simulate and develop thermal control and regulation systems. The TCLab features a feedback control application with an Arduino, an LED, 2 heaters and 2 temperature sensors:</p>
<ul class="simple">
<li><p>one heater will represent the TCS heating elements used for temperature control.</p></li>
<li><p>another will represent external disturbances such as solar radiation in the Cubesat application.</p></li>
</ul>
<p>During this tutorial we will start using this card and carry out temperature measurements on control steps. The aim is to identify a dynamic model that can be used to synthesise the control. In this second part of the tutorial, we‚Äôll identify a transfer function to represent the step response previously measured.</p>
<blockquote>
<div><p>Follow the steps below in Colab, using the measurement file provided. When revising, you can repeat these steps with your measurements in Anaconda.</p>
</div></blockquote>
<section id="fitting-the-step-change-data-to-a-first-order-model">
<h2><span class="section-number">2.2.1. </span>Fitting the Step Change Data to a First Order Model<a class="headerlink" href="#fitting-the-step-change-data-to-a-first-order-model" title="Permalink to this heading">#</a></h2>
<p>For a first-order linear system initially at steady-state, the response to a step input change at <span class="math notranslate nohighlight">\(t=0\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[y(t) = y(0) + K(1 - e^{-t/\tau}) \Delta U\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta U\)</span> is the magnitude of the step change. Converting to notation used for the temperature control lab where <span class="math notranslate nohighlight">\(y(t) = T_1(t)\)</span> and <span class="math notranslate nohighlight">\(\Delta U = \Delta Q_1\)</span></p>
<div class="math notranslate nohighlight">
\[T_1(t) = T_1(0) + K_1(1 - e^{-t/\tau_1}) \Delta Q_1\]</div>
<blockquote>
<div><p><strong>Questions:</strong></p>
<ul class="simple">
<li><p>Recall the differential equation and the transfer function of a 1st order SISO (Single Input Single Output) dynamic system. Use notations compatible with the description of the step response above.</p></li>
<li><p>Identify the steady state gain <span class="math notranslate nohighlight">\(K_1\)</span> and time constant <span class="math notranslate nohighlight">\(\tau_1\)</span></p></li>
<li><p>Compare the 1st order response with the measured data. Conclusion.</p></li>
</ul>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># With this line : no print </span>
<span class="o">%%</span><span class="k">script</span> echo skipping

import pandas as pd

# Read data
df = pd.read_csv(&#39;https://github.com/SizingLab/SystemsEngineeringIntroduction/blob/main/notebook/Step_Test_Data.csv&#39;) # provided data 
# df = pd.read_csv(&#39;./data/Step_Test_Data.csv&#39;) # my data 

df = df.set_index(&#39;Time&#39;)

T1 = df[&#39;T1&#39;]
Q1 = df[&#39;Q1&#39;]

# Static gain K1
# complete

# Time constant tau1
# complete


import matplotlib.pyplot as plt
import numpy as np

exp = np.exp
t = df.index

T1_est = T1.min() + K1*(1 - exp(-t/tau1))*DeltaQ1

plt.figure(figsize=(10,5))
ax = plt.subplot(2,1,1)
df[&#39;T1&#39;].plot(ax = ax, grid=True)
plt.plot(t,T1_est)
plt.title(&#39;Step Test Data Compared to Model&#39;)

plt.subplot(2,1,2)
plt.plot(t,T1_est-T1)
plt.grid()
plt.title(&#39;Residual Error&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: Line magic function `%%script` not found.
</pre></div>
</div>
</div>
</div>
</section>
<section id="nodal-thermal-model">
<h2><span class="section-number">2.2.2. </span>Nodal thermal model<a class="headerlink" href="#nodal-thermal-model" title="Permalink to this heading">#</a></h2>
<p>We will show here that a physical model made up of thermal resistances and capacities can explain the dynamic responses observed and the transfer functions identified previously.</p>
<blockquote>
<div><p><strong>Questions:</strong></p>
<ul class="simple">
<li><p>Recall the characteristic equations for thermal resistances and capacities relating temperatures <span class="math notranslate nohighlight">\(T_i\)</span> and heat flows (power) <span class="math notranslate nohighlight">\(P\)</span>.</p></li>
<li><p>Select the thermal model to represent the temperature rise if we assume that the heating element and the temperature sensor are at the same temperature.</p></li>
<li><p>Determine the values of the thermal resistance <span class="math notranslate nohighlight">\(R_{th}\)</span> and the thermal capacity <span class="math notranslate nohighlight">\(C_{th}\)</span> from the 1st order transfer function identified above. Assume that the maximum power of the heating element (4W) and the outside temperature are known.</p></li>
</ul>
</div></blockquote>
<p><img alt="Mod√®le thermique 1 corps" src="notebook/figures/Order1.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># With this line : no print </span>
<span class="o">%%</span><span class="k">script</span> echo skipping

%matplotlib inline
import numpy as np                  # basic package for numerical calculations
import matplotlib.pyplot as plt     # plotting package
from scipy.signal import step       # Import from scipy of the step response

# parameter values and units
# complete

# First order step response
num = [Rth]
den = [Rth*Cth, 1]
t, y = step(system=(num, den))
T1_est = T_ambient  + P1*y

plt.figure(figsize=(10,5))
ax = plt.subplot(1,1,1)
df[&#39;T1&#39;].plot(ax = ax, grid=True)
plt.plot(t,T1_est)
plt.title(&#39;Step Test Data Compared to Model&#39;)
plt.show()

#Print data
print(&quot;Thermal resistance Rth = %.2f K/W&quot;%Rth)
print(&quot;Thermal capcitance Cth = %.2f J/K&quot;%Cth)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: Line magic function `%%script` not found.
</pre></div>
</div>
</div>
</div>
<p>The parameter values in the above plot were chosen to (at least roughly) reproduce the measured response of temperature control laboratory. The <a class="reference external" href="https://en.wikipedia.org/wiki/Heat_capacity">specific heat capacity for solids</a> is typically has values in the range of 0.2 to 0.9 J/K/gram. Using a value of 0.9 that is typical of aluminum and plastics used for electronic products, the estimated mass of the heater/sensor pair would be:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Equivalent mass : </span><span class="si">%.2f</span><span class="s2"> g&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cth</span><span class="o">/</span><span class="mf">0.9</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Equivalent mass : </span><span class="si">%.2f</span><span class="s2"> g&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cth</span><span class="o">/</span><span class="mf">0.9</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;Cth&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="two-state-model">
<h2><span class="section-number">2.2.3. </span>Two State Model<a class="headerlink" href="#two-state-model" title="Permalink to this heading">#</a></h2>
<section id="from-first-order-to-second-order-thermal-model">
<h3><span class="section-number">2.2.3.1. </span>From first order to second order thermal model<a class="headerlink" href="#from-first-order-to-second-order-thermal-model" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p><strong>Question:</strong> Explain why the 1st order model is not completely satisfactory.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Question:</strong> Propose a nodal thermal diagram to represent the observed dynamics, taking into account the response of the temperature sensor. For this third model, we consider the possibility that the heater and sensor may not be at the same temperature. In other words, that the heater/sensor assembly is not at a uniform temperature. To account for this possibility, we introduce <span class="math notranslate nohighlight">\(ùëá_ùêª\)</span> to denote the temperature of heater one and <span class="math notranslate nohighlight">\(ùëá_ùëÜ\)</span> to denote the temperature of the corresponding sensor. We‚Äôll further assume that sensor mainly exchanges heat with the heater, and the dominant heat transfer to the surroundings is through the heat sink attached to the heater.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercice or homework:</strong> Determine the form of the transfer function corresponding to this thermal diagram. The input is the temperature rise in %, the output is the temperature measurement in ¬∞C.</p>
</div></blockquote>
</section>
<section id="fitting-a-second-order-model-by-least-squares">
<h3><span class="section-number">2.2.3.2. </span>Fitting a Second Order Model by Least Squares<a class="headerlink" href="#fitting-a-second-order-model-by-least-squares" title="Permalink to this heading">#</a></h3>
<p>Graphically determining a large number of parameters can be difficult. Second-order parameters can be determined using the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html">least_square function</a>, which minimises an error by optimisation.</p>
<blockquote>
<div><p><strong>Exercice:</strong> Propose a Python code to determine the second-order transfer function best suited to the measurement.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># With this line : no print </span>
<span class="o">%%</span><span class="k">script</span> echo skipping

from scipy.optimize import least_squares
import numpy as np
Qmax = 50

def f(x):
# complete
    return resid

ic = [0.86,40,130,20]

r = least_squares(f,ic,bounds=(0,np.inf))
r.x
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: Line magic function `%%script` not found.
</pre></div>
</div>
</div>
</div>
<p>For the next tutorial, we‚Äôll use the following transfer function:
<span class="math notranslate nohighlight">\( G_1(s) = \frac{0.65}{(27s + 1)(160s + 1)} \)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># With this line : no print </span>
<span class="o">%%</span><span class="k">script</span> echo skipping

%matplotlib inline
import numpy as np                  # basic package for numerical calculations
import matplotlib.pyplot as plt     # plotting package
from scipy.signal import step       # Import from scipy of the step response

# First order step response
num = [0.657]
den = [160*27,160+27,1]
t, y = step(system=(num, den),T=np.linspace(0,600,100))
T1_est = 20.25  + y*50

plt.figure(figsize=(10,5))
ax = plt.subplot(1,1,1)
df[&#39;T1&#39;].plot(ax = ax, grid=True)
plt.plot(t,T1_est)
plt.title(&#39;Step Test Data Compared to Model&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: Line magic function `%%script` not found.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="correction">
<h2><span class="section-number">2.2.4. </span>Correction<a class="headerlink" href="#correction" title="Permalink to this heading">#</a></h2>
<p>An example of correction can be found <span class="xref myst">here</span></p>
</section>
<section id="references">
<h2><span class="section-number">2.2.5. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<p>[Hedengren] Hedengren, J., Process Dynamics and Control, Brigham Young University.  <a class="reference external" href="http://apmonitor.com/pdc/index.php/Main/ArduinoTemperatureControl">Link</a></p>
<p>[Kantor, 2021] Kantor, JC., Chemical Process Control class materials, University of Notre Dame. <a class="reference external" href="https://jckantor.github.io/cbe30338-2021/">Link</a> / <a class="reference external" href="https://github.com/jckantor/cbe30338-2021">Github</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebook"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06a_TD2_TCLab_Step-Student.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.1. </span>Temperature Control Lab, step identification (a)</p>
      </div>
    </a>
    <a class="right-next"
       href="07_TD_PID_ControlLoops-Student.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.3. </span>PID digital controller: Python implementation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-step-change-data-to-a-first-order-model">2.2.1. Fitting the Step Change Data to a First Order Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nodal-thermal-model">2.2.2. Nodal thermal model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-model">2.2.3. Two State Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-first-order-to-second-order-thermal-model">2.2.3.1. From first order to second order thermal model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-second-order-model-by-least-squares">2.2.3.2. Fitting a Second Order Model by Least Squares</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction">2.2.4. Correction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">2.2.5. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marc Budinger, INSA Toulouse
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>